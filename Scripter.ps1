write-Host -ForegroundColor Red ---------------------------------------------
write-Host -ForegroundColor Green '            New Scripter V2.0'
write-Host -ForegroundColor DarkBlue ---------------------------------------------
write-Host 
 "
  _ ___ _ __    ___  ___ ___ __  __ __
  | || | __| |  | _ \   \| __/ __| |/ /
  | __ | _|| |__|  _/ |) | _|\__ \ ' < 
  |_||_|___|____|_| |___/|___|___/_|\_\ 
 "
                                     

write-Host -ForegroundColor Red '                                by iTayDa'
write-Host ''
    # Get UserName and PWord from user PROMP
        write ''
        Write-Host -ForegroundColor Blue 'Login to Domain POSPROD'
        $domain = 'posprod\'
        write ''
        $User = Read-Host -Prompt 'UserName'
        $PWord = Read-Host -Prompt 'Password' -AsSecureString
        $domainUser = $domain+$user
        $Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $domainUser, $PWord
        write ''



do
{
$choose = 111111111111
$prompt = 000000000000
cls
Write-Host -ForegroundColor Cyan "        Hello" $User
Write-Host -ForegroundColor DarkYellow 'Welcome to Scripter V2.0 '
Write-Host -ForegroundColor green
"Printer fix-RPC enable -- 1 
Restart Computer       -- 2 
IVANTI-White Screen    -- 3
EMV & KUPA Ping        -- 4
KILDUN Service Reset   -- 5
Regel 8- network       -- 6
NetScale Removal       -- 7
RC Viewer Removal      -- 8
issuser reset          -- 9
AutoLogon              -- 10
Kupa D:\ Clean logs    -- 11
 "
$prompt = Read-Host -Prompt ' '

cls

if ($prompt -eq 1 ) ##Printer fix-RPC enable
 {
 
 Write-Host -ForegroundColor Green 'RPC - Fix and Spoolers Restart'
 
 # Get target Computer name 
$targetComputer = Read-Host -Prompt 'enter Target Computer' 

#Invoke the command on the target computer with the Credentials provided 

Invoke-Command -ComputerName $targetComputer -Credential $Credential -ScriptBlock {
 # Define the path to the registry key
 $registryPath = "HKLM:\System\CurrentControlSet\Control\Print"

 # Define the name and value of the registry entry
  $entryName = "RpcAuthnLevelPrivacyEnabled"
 # entryName = "TEST"
 $entryValue = 0  # DWORD value

 # Check if the registry key exists, if not, create it
 if (-not (Test-Path $registryPath)) {
     New-Item -Path $registryPath -Force
 }

 # Add the registry entry
 New-ItemProperty -Path $registryPath -Name $entryName -Value $entryValue -PropertyType DWord -Force

 write-Host "Registry key added successfully."
 write ''

 # restart Print-Spooler
 gsv spooler | Restart-Service -Force
 write-Host -ForegroundColor DarkGreen 'Spooler Restarted'
 gsv SAPSprint | Start-Service
 write-Host -ForegroundColor DarkGreen 'SAPSprint Started'
 gsv lpdsvc | Start-Service
 write-Host -ForegroundColor DarkGreen 'lpdsvc Started'
 }

 write-Host ''
 write-Host ''
 write-Host -ForegroundColor DarkGreen '========== Scripted' $targetComputer 'using' $domainUser 'Credentials ==========' 
 write-Host ''

 Pause
 }
 elseif ($prompt -eq 2) ##Restart Computer
 {
 Write-Host -ForegroundColor Green 'Restart Remote Computer'

             $targetComputer = Read-Host -Prompt 'enter Target Computer (WKS-999-999) ' 
             Restart-Computer -ComputerName $targetComputer  -Credential $Credential  -Force
             write-host $targetComputer 'has Been Restarted by' $domainUser 
             write '' 
             ping  $targetComputer -n 60

                      pause
                      cls
 }
 elseif ($prompt -eq 3) ##IVANTI-White Screen
 {
 Write-Host -ForegroundColor Green 'Ivanti White Screen Fix'

                # Get Computer Name WL\PL 
                $targetServer = Read-Host -Prompt 'enter WLpossrv or PLpossrv of the SNIFF (WLPOSSRV999 or PLPOSSRV999) '

                #get Computer that Has WHITE SCREEN 
                 $targetComputer = Read-Host -Prompt 'Enter the Computer with the Problem' 

                #Stop Services on the server 
                Invoke-Command -ComputerName $targetServer -Credential $Credential -ScriptBlock {gsv  *LANDES* | Stop-Service -Verbose}

                #Restart The Problematic PC 
                $chiose =Read-Host -Prompt 'reset the PC? (0\1) '
                  if ($chiose -eq 1){
                        $sure =Read-Host -Prompt 'Are You Sure? (0\1)' 
                         if ($sure -eq 1){                  
                                           Restart-Computer -ComputerName $targetComputer -Force 
                                            write 'Pc Restarted' 
                                          }
                                         } 
                                          else { write 'PC NOT Restarted '}

                #Ping the PC 
                ping $targetComputer -n 60
                pause
                cls
 }
 elseif ($prompt -eq 4) ##EMV PINGER 
 {
 Write-Host -ForegroundColor Green 'Ping Kupa And EMV '

                 $snif = Read-Host -Prompt 'snif '
                 $kupa = Read-Host -Prompt 'kupa '
                 $pos = [int]$kupa+10 
                 $emv = [int]$kupa+150 

                    write '' 

                     $posIp = '10.1'+$snif[0]+'.'+$snif[1]+$snif[2]+ '.' + $pos
                     $posEmv = '10.1'+$snif[0]+'.'+$snif[1]+$snif[2]+ '.' + $emv
                     
                ping $posIp -n 1 
                ping $posEmv -n 20   

                pause
                cls
 }
 elseif ($prompt -eq 5) ##Restart KILDUNSRV service
 {

 Write-Host -ForegroundColor Green 'KildunSrv - Restart Service '
             
             Write-Host -ForegroundColor Yellow 'Attempting Restart'
             Invoke-Command -ComputerName shilutsrv -Credential $Credential -ScriptBlock {gsv  kildunsrv | Restart-Service -Verbose }
             write ''
             Invoke-Command -ComputerName shilutsrv -Credential $Credential -ScriptBlock {gsv  kildunsrv}

                      pause
                      cls
 }
 elseif ($prompt -eq 6) ##REGEL 8 
 {

 Write-Host -ForegroundColor Green 'Enable NetAdpter 8  '
    
            # Get target Computer name 
            $targetComputer = Read-Host -Prompt 'enter Target server (wlpossrv999 )' 

            #status of Net Adpters
            Invoke-Command -Credential $Credential -ComputerName $targetComputer -ScriptBlock {Get-NetAdapter }
            write '' 
            write-host -ForegroundColor DarkYellow 'Cheking if there is a NetworkAdpter Down and Enable it.'
            Invoke-Command -Credential $Credential -ComputerName $targetComputer -ScriptBlock {Get-NetAdapter -Verbose|where -Property Status -EQ 'Disabled' -Verbose| Enable-NetAdapter -Verbose}

            pause
            cls


 }
 elseif ($prompt -eq 7) ##Netscale Removal)
 {

 Write-Host -ForegroundColor Green 'Remove Netscale Files'

# Define the remote computer name
$remoteComputer = Read-Host -Prompt 'enter target (WLPOSSRV999)' 


# Define the path to the main folder and the subfolder to exclude
$mainFolderPath = "C:\bolet\data\netscale"
$excludeFolderPath = "C:\bolet\data\netscale\images"

# Create a script block to run on the remote computer
$scriptBlock = {
    param ($mainFolderPath, $excludeFolderPath)
    
    # Get all items in the main folder except the excluded folder
    $items = Get-ChildItem -Path $mainFolderPath -Recurse -Verbose| Where-Object { $_.FullName -notlike "$excludeFolderPath*"  }

    # Remove the items
    foreach ($item in $items) {
        if ($item.PSIsContainer) {
            Remove-Item -Verbose -Path $item.FullName -Recurse -Force
        } else {
            Remove-Item -Verbose -Path $item.FullName -Force
        }
    }

    Write-host -ForegroundColor Red "Contents of $mainFolderPath have been removed"
    Write-Host -ForegroundColor Green "excluding $excludeFolderPath."
}

# Invoke the script block on the remote computer
Invoke-Command -ComputerName $remoteComputer -Credential $Credential -ScriptBlock $scriptBlock -ArgumentList $mainFolderPath, $excludeFolderPath

Pause
cls
 }
 elseif ($prompt -eq 8) ## RC Viewer cancel)
 {

 Write-Host -ForegroundColor Green 'Remote Control Message Remove '

 # Get target Computer name 
$targetComputer = Read-Host -Prompt 'enter Target Computer' 

#Invoke the command on the target computer with the Credentials provided 

Invoke-Command -ComputerName $targetComputer -Credential $Credential -ScriptBlock {gps rcuser -Verbose | Stop-Process -Force -Verbose}
Write-Host -ForegroundColor Cyan 'Process Killed by' $domainUser 'on' $targetComputer 'Successfully'

pause
cls
 }
 elseif ($prompt -eq 9) ##ISSUSER RESET
 {

 Write-Host -ForegroundColor Green 'ISSUSER - Reset Service '
    
$targetComputer = Read-Host -Prompt 'enter Target Computer' 
Invoke-Command -ComputerName $targetComputer -Credential $Credential -Verbose -ScriptBlock {
gsv  *ISSUSER* | Stop-Service -Force -Verbose
gsv  *ISSUSER* | Start-Service  -Verbose
}

write ''

write-host -ForegroundColor Green 'Done!'
Pause 
cls
 }
 elseif ($prompt -eq 10) # AutoLogon Disable 
 {
 Write-Host -ForegroundColor Green 'Auto Logon - MANAGER '


   $targetComputer = Read-Host -Prompt "Enter Target"
   cls
   write-host -ForegroundColor Yellow "target is" $targetComputer
   write-host -ForegroundColor Red "to Disable Enter D"
   write-host -ForegroundColor Green "to Enable Enter E"
   $choose =Read-Host -Prompt "Choose"
   
   if ($choose -eq "D" ){
   Write-Host -ForegroundColor Red "Disabling"
    Invoke-Command -ComputerName $targetComputer -Credential $Credential -ScriptBlock {
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "AutoAdminLogon" -Value 0 -Verbose
    Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "AutoAdminLogon"
    }
    } 
    }if ($choose -eq "E"){
   Write-Host -ForegroundColor Green "Enabling"
    Invoke-Command -ComputerName $targetComputer -Credential $Credential -ScriptBlock {
    Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "AutoAdminLogon" -Value 1 -Verbose
    Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "AutoAdminLogon"
    }
    
   }
 elseif ($prompt -eq 11) # Kupa D:\ Clean logs
{
Write-Host -ForegroundColor Green 'Clean Old Logs'
#Get Target Computer
$targetComputer = Read-Host -Prompt "Enter Kupa"

Invoke-Command -ComputerName $targetComputer -Credential $Credential -ScriptBlock{

# Define the path to the directory
# LOCAL - $directoryPath = "\\$($targetComputer)\d\retalix\AppLogs\log2005"
$directoryPath = "D:\retalix\AppLogs\log2005"


# Get the current date
$currentDate = Get-Date

# Calculate the date one month ago
$oneMonthAgo = $currentDate.AddMonths(-1)

# Get all files in the directory, excluding those created in the last month
$files = Get-ChildItem -Path $directoryPath -Recurse | Where-Object { $_.LastWriteTime -lt $oneMonthAgo }

# Output the files
#$files | ForEach-Object { Write-Output $_.FullName ,Write-Output $_.LastWriteTime }

#Count the files Before delete
$PreDelete = $files | Measure-Object | select -Property Count 


# Remove the files
#$files | Remove-Item -Force -Verbose 


$files | foreach-object {
    $num += 1    
    Write-Progress -Activity "Deleting Files" -Status "$_ %" -Id 1 -PercentComplete  (($num / $files.count) * 100) 
    $_ | Remove-Item  }

    write-host -ForegroundColor Green $num "Files Deleted"

#Count the files After delete
$PostDelete = Get-ChildItem -Path $directoryPath -Recurse | Measure-Object | select -Property Count 
$num = 0 



}
#Display conclution


} 
 elseif($prompt -eq 12)
 {

    start .\powershell.exe  {

    $var = Read-Host 'enter'
    write $var
     Pause
     Pause
    }
 }
   
 
 Pause
    cls
    write-host "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     















                                                                                                                                                                                                                                      "
 }
 #end loop
 until (1 -eq 2)